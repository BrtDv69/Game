/* Table: PROGRAMMS_COMPS */

CREATE TABLE PROGRAMMS_COMPS (
    ID_PROG INTEGER NOT NULL,
    ID_COMP INTEGER NOT NULL);





/* Foreign keys definition */

ALTER TABLE PROGRAMMS_COMPS ADD CONSTRAINT FK_PROGRAMMS_COMPS FOREIGN KEY (ID_PROG) REFERENCES PROGRAMMS (ID_PROG) ON DELETE SET DEFAULT ON UPDATE SET DEFAULT;
ALTER TABLE PROGRAMMS_COMPS ADD CONSTRAINT FK_PROGRAMMS_COMPS2 FOREIGN KEY (ID_COMP) REFERENCES COMPS (ID) ON DELETE SET DEFAULT ON UPDATE SET DEFAULT;
/* Triggers definition */


SET TERM ^ ;





/* Trigger: PROGRAMMS_COMPS_AD0 */
CREATE TRIGGER PROGRAMMS_COMPS_AD0 FOR PROGRAMMS_COMPS
ACTIVE AFTER DELETE POSITION 0
as
begin
 update PROGRAMMS set NUMBER_OF_COMPS=NUMBER_OF_COMPS-1
 where ID_PROG=OLD.ID_PROG;
end
^

/* Trigger: PROGRAMMS_COMPS_AD1 */
CREATE TRIGGER PROGRAMMS_COMPS_AD1 FOR PROGRAMMS_COMPS
ACTIVE AFTER DELETE POSITION 1
as
begin
 update COMPS set HASHSUM=gen_id(GEN_PROG_CHANGE,1)
 where ID=OLD.ID_COMP;
end
^

/* Trigger: PROGRAMMS_COMPS_BI0 */
CREATE TRIGGER PROGRAMMS_COMPS_BI0 FOR PROGRAMMS_COMPS
ACTIVE BEFORE INSERT POSITION 0
as
begin
 update PROGRAMMS set NUMBER_OF_COMPS=NUMBER_OF_COMPS+1
 where ID_PROG=NEW.ID_PROG;
end
^

/* Trigger: PROGRAMMS_COMPS_BI1 */
CREATE TRIGGER PROGRAMMS_COMPS_BI1 FOR PROGRAMMS_COMPS
ACTIVE BEFORE INSERT POSITION 1
as
begin
 update COMPS set HASHSUM=gen_id(GEN_PROG_CHANGE,1)
 where ID=NEW.ID_COMP;
end
^

/* Trigger: PROGRAMMS_COMPS_BU0 */
CREATE TRIGGER PROGRAMMS_COMPS_BU0 FOR PROGRAMMS_COMPS
ACTIVE BEFORE UPDATE POSITION 0
as
begin
 update COMPS set HASHSUM=gen_id(GEN_PROG_CHANGE,1)
 where (ID=NEW.ID_COMP)or(ID=OLD.ID_COMP);
end
^


SET TERM ; ^
