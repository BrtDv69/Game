
      -------------------------------------------------------------------  
      -                       INSTDRV.EXE                               -  
      -  Утилита установки драйверов для электронных ключей Guardant    -  
      -------------------------------------------------------------------  
                                                                             

 Т.к. работа утилиты установки во многом схожа в Windows 95/98/Me и Windows 
 NT/2000/XP, данный файл содержит единое подробное описание для этих операци-
 онных систем с указанием различий.

 В момент  запуска  программы  следующие  файлы должны находится  в том же
 каталоге, что и INSTDRV.EXE:

 Windows 95/98/Me:        NVKEY95.VX_  - Драйвер Windows 95/98/Me
                          NVKEYU95.SYS - Драйвер USB для Windows 95 OSR 2.x
                          NVKEYUSB.SYS - Драйвер USB для Windows 98/Me
                          NVKEY98U.SYS - Вспомогательный драйвер USB для
                                         Windows 98/Me
                          GSNUSB.IN_   - Служебный файл для драйверов USB
                          INSTDRV.INI  - Установки по умолчанию

 Windows NT/2000/XP:      NVKEYNT.SYS  - Драйвер ядра Windows 2000/XP
                          NVKEYNT4.SYS - Драйвер ядра Windows NT
                          NVKEYVDD.DLL - Виртуальный драйвер (для DOS)
                          NVKEY4NT.SYS - DOS драйвер устройства
                          NVKEYUSB.SYS - Драйвер USB для Windows 2000
                          GSNUSB.IN_   - Служебный файл для драйвера USB
                          INSTDRV.INI  - Установки по умолчанию

        При запуске программа INSTDRV.EXE выдаст на экран главное окно.
        При запуске INSTDRV проверит наличие в системе драйвера Guardant
Если драйвер не найден, в окне будет доступна  только  1-я кнопка, и она 
будет называться [Установить драйвер].


                  --------------------------
                  -   УСТАНОВКА ДРАЙВЕРА   -
                  --------------------------

    Для установки драйвера Guardant (или замены уже установленного драй-
вера его более новой  версией)  нажмите  кнопку  [Установить(Переустано-
вить)]. При  его  успешной установке INSTDRV  выдаст соответствующее со-
общение, после чего произойдет возврат в главное окно.


      -------------------------------------------------------------
        ВАЖНО !!!                                                  
                                                                   
            Во время установки драйверов ВСЕ приложения и          
           особенно  DOS  сессии  должны  быть  закрыты !          
           В противном случае  возможны ошибки разделения          
           файлов!                                                 
            Драйвер  для USB-ключей Guardant  можно уста-          
           навливать только при помощи программы  INSTDRV          
           или функций  API  для работы  с драйверами. Не          
           следует делать это "вручную"  при помощи стан-           
           дартного мастера Windows.                               
            USB-ключи  Guardant  не следует  подключать к          
           компьютеру  до установки драйверов, иначе Win-          
           dows начнет самостоятельный поиск драйвера для          
           них. Если же это произошло, следует отказаться          
           от  поиска  драйвера  мастером  Windows, нажав          
           кнопку  [Отмена],  и отсоединить  USB-ключ  от          
           компьютера.                                             
                                                                   
        Для Windows NT/2000/XP также необходимо, чтобы                
                                                                   
           Пользователь, который работает с утилитой уста-         
           новки, обладал правами АДМИНИСТРАТОРА  системы.         
           Для пользователей с обычными правами Windows NT         
           запрещает операции установки, удаления и конфи-         
           гурирования драйверов                                   
                                                                   
      -------------------------------------------------------------

                 --------------------------------
                 -   КОНФИГУРИРОВАНИЕ ДРАЙВЕРА  -
                 --------------------------------

        Вы можете настроить параметры работы  установленного  в систему
драйвера  Guardant. Для этого  в главном  окне INSTDRV  нажмите  кнопку 
[Конфигурирование драйвера].

        Процесс конфигурирования драйвера состоит из
        - задания портов для поиска ключа
        - задания способов захвата каждого из заданных LPT-портов
        - установки таймаута для LPT-портов
        - дополнительных настроек  LPT-портов:  выбора метода задержек и 
          используемого таймера  (рекомендуется их НЕ ТРОГАТЬ!), а также
          настройки базовых адресов LPT-портов

        Задание портов для поиска ключа
        -------------------------------
        В левой верхней  части окна отображается список найденных на Ва-
 шем компьютере параллельных портов. Кроме того, если  на компьютере ус-
 тановлено  аппаратное  и программное обеспечение  для работы с USB-уст-
 ройствами, в списке портов  присутствует  строка "USB".  Вы можете ука-
 зать,  на каких  портах  драйвер  должен производить  поиск ключей. Это 
 очень полезно для уменьшения  времени ответа ключа. Например, если ключ 
 в вашем компьютере подсоединен к порту LPT2, а к LPT1 подсоединен прин-
 тер, то можно  запретить использование порта  LPT1  для поиска ключа. А 
 если вы используете  только USB-ключи Guardant, вы можете запретить по-
 иск ключей на всех LPT-портах. По умолчанию поиск разрешен на всех USB- 
 и LPT-портах вашего компьютера.
        В Windows 95/98/Me рядом с именем LPT-порта отображается его ба-
 зовый адрес.

        Задание способов захвата LPT-порта
        ----------------------------------
        Захват параллельного  порта необходим  во избежание конфликтов в
случаях, когда  защищенное приложение пытается обратиться  к ключу в тот
момент, когда другое приложение  использует тот же порт, к которому при-
соединен ключ  (например, происходит  печать на принтер).  Захват  порта
драйвером  производится  только  на время  общения с  ключом, после чего
порт освобождается.

        По умолчанию утилита конфигурации   устанавливает автоматический
способ  захвата.  Остальные  способы  имеет  смысл  использовать  ТОЛЬКО
опытным пользователям, хорошо знакомым  с тонкостями работы операционной
системы и переферийных устройств.

        Каждому  из выбранных параллельных портов  вы можете задать свое
сочетание способов захвата.


        Установка таймаута для LPT-портов
        ---------------------------------
        В случае если  параллельный порт,  к которому  драйвер  Guardant
пытается получить доступ, оказывается занятым,  драйвер  начинает  ждать
момента освобождения порта.  Время ожидания драйвера  называется таймау-
том. В течение этого времени он будет постоянно проверять состояние пор-
та и, если порт так и остался занятым, защищенному приложению будет воз-
вращена ошибка #24 (Port busy).

        Значение  таймаута  в  секундах  задается  в нижней  части окна. 
Допустимые значения - от 0.001 до 600 секунд. Значение таймаута по умол-
чанию - 10 секунд.

        Дополнительные настройки для LPT-портов
        ---------------------------------------
        Окно  дополнительных  настроек  LPT-портов  вызывается  нажатием
кнопки [Дополнительно]  в нижней части окна конфигурирования драйвера. В 
появившемся окне  можно выбрать  метод формирования задержек и использу-
емый таймер, а также настроить базовые адреса LPT-портов (последнее осо-
бенно важно для LPT-портов с нестандартными базовыми адресами).

        1. Выбор метода формирования задержек и используемого таймера.
        Начиная с версии  3.2  в драйвере Guardant появилась возможность 
выбирать метод формирования задержек и используемый таймер. По умолчанию
установлен  способ  [Автоматически],  при котором драйвер самостоятельно 
определяет наиболее стабильно работающий таймер и способ задержек.
        Снятие автоматического способа  и изменение данных настроек НАС-
ТОЯТЕЛЬНО НЕ РЕКОМЕНДУЕТСЯ, т. к. это может  привести к нестабильной ра-
боте всей системы, ошибкам обмена с электронным ключом и т.п.

        2. Настройка базовых адресов LPT-портов.
        Начиная с версии  4.52 в драйвере Guardant появилась возможность
настраивать  базовые адреса LPT-портов, используемые драйвером для обме-
на с электроыыми ключами. По умолчанию установлен режим  автоматического  
определения адресов самим драйвером Guardant. Адреса LPT-портов, опреде-
ленные драйвером, отображаются в соответствующих полях ввода.  
        Отключение автоматического режима и корректировка адресов требу-
ется только в том случае, если драйверу  не удалось верно определить ба-
зовый адрес какого-либо LPT-порта.

ПРИМЕЧАНИЕ: 
        Дополнительные настройки вступают  в силу ТОЛЬКО  после  нажатия
        кнопки [OK] в ОСНОВНОМ ДИАЛОГЕ конфигурирования.
        Если нажать [OK] в дополнительном диалоге и [Отмена] в основном,
        то изменения произведены НЕ БУДУТ!


----------------------------------------------------------------------

        После задания всех  нужных параметров  нажмите кнопку [Ok] (или 
кнопку [Отмена] для отмены изменений). Произойдет выход в главное  окно
утилиты.
        Во время  первого запуска INSTDRV  (т.е. когда драйвер Guardant 
еще не был загружен)  умалчиваемые значения  параметров считываются  из 
файла INSTDRV.INI, находящегося в том же каталоге, что и сама утилита.
       Все заданные  Вами  параметры  записываются в системный реестр и
в дальнейшем считываются оттуда как драйвером Guardant,  так и утилитой.

       После конфигурирования драйвера перезагрузка системы не требует-
ся.  Все  внесенные  Вами изменения вступают в силу сразу после нажатия 
кнопки [ОК] в диалоге настройки.



                 ----------------------------
                 -  ПЕРЕУСТАНОВКА ДРАЙВЕРА  -
                 ----------------------------

        При переустановке драйвера последовательно выполняется два дей-
ствия: УДАЛЕНИЕ и УСТАНОВКА драйвера.

ВНИМАНИЕ!  В Windows 95/98/Me после переустановки необходимо перезагру-
           зить  компьютер, т.к. удаленный драйвер  остается  активен в  
           памяти до перезагрузки системы


                   ------------------------
                   -   УДАЛЕНИЕ ДРАЙВЕРА  -
                   ------------------------

        Для удаления загруженного в систему драйвера нужно нажать кноп-
ку [Удалить драйвер] в главном окне INSTDRV. В режиме удаления драйвера 
утилита удаляет файлы драйвера.

ВНИМАНИЕ!   В Windows 95/98/Me после удаления драйвер остается активным 
           до перезагрузки системы. 
            Драйвер  для USB-ключа остается активным  до момента отклю-
           чения USB-ключа от компьютера либо до перезагрузки системы.


           -------------------------------------------
           -   ИСПОЛЬЗОВАНИЕ ОПЦИЙ КОМАНДНОЙ СТРОКИ  -
           -------------------------------------------

Возможно использование утилиты INSTDRV из командной строки. При запуске
с опциями командной строки главное окно не выводится.

        Программа установки поддерживает следующие опции
        ------------------------------------------------
/H
/?    - Выдать окно подсказки со списком доступных опций.

/U    - Удалить  драйвер  из  системы  (без  опции /Q  не  имеет  смысла;
        пользователь  просто попадает  в главное окно, где должен  нажать 
        кнопку [Удалить]).

/I    - Подробно сообщать о происходящих ошибках. Опцию  не стоит исполь-
        зовать  без необходимости, т.к. сообщается и  о  ошибках, которые
        на результат  операции  никак не влияют (например: невозможно от-
        крыть драйвер - драйвер просто не установлен).

/LE
/LR   - Принудительная установка языка сообщений. По умолчанию язык опре-
        деляется автоматически в зависимости  от номера  активной кодовой
        страницы, и все сообщения и диалоги выдаются на родном языке.
        (/LE - английский; /LR - русский).

/Q    - Ничего не показывать на экране. Ответы на все вопросительные диа-
        логи подразумеваются как положительные.
        Полезна  при запуске  INSTDRV из других приложений.  По умолчанию
        инсталлирует, а с опцией /U - убирает драйвер.

/RB   - Игнорировать  опцию  /Q   для  вопроса  о  перезагрузке  системы.
        Если указана  опция /Q  и  не  указана /RB,  то при необходимости 
        перезагрузки утилита  сделает это  без  вопросов,  что  не всегда 
        удобно.

/NORB - Не перезагружать систему ни в коем случае.

/LOG  - Сохранять все действия в LOG-файл. Файл _INSTDRV.LOG  создается в 
        том-же каталоге, где находится INSTDRV.EXE. Если файл по каким-то 
        причинам  не может быть  создан  (например, INSTDRV.EXE находится 
        на CD), то он создается в %SYTEMROOT%\SYSTEM для Windows 95/98/Me 
        и в %SYSTEMROOT%\SYSTEM32\DRIVERS для Windows NT/2000/XP.

                        Коды возврата
                        -------------
        Коды возврата  выдаются утилитой  в пакетном  режиме работы (т.е.
когда работа утилиты  не сопровождается  появлением  окон - например, при
запуске INSTDRV с опцией /Q).  В оконном режиме  при возникновении ошибки
выдается соответствующее сообщение.
        Существуют следующие коды возврата:

        0 - Работа завершена успешно.
        1 - Операция прервана пользователем.
        2 - Попытка установить драйвер  не в Windows 95/98/Me или Windows 
            NT/2000/XP.
        3 - Ошибка в процессе установки.
        4 - Недостаточно прав у пользователя (только Windows NT/2000/XP)
        5 - Драйвер занят другим приложением
       -1 - Код возврата после выдачи подсказки (/?, /H).


-----------------------------------------------------------------------------
             Служба сопровождения и поддержки компании Актив:

     Офис:     Россия, 119146 Москва, Комсомольский пр-т, 9а
     Тел/факс: +7 (095) 956-2280, 246-4066, 245-3158
     E-mail:   guardant@guardant.ru (общие вопросы),
               hotline@guardant.ru  (техническая поддержка)
     Web Site: http://www.guardant.ru

                                        